# Вы можете расположить сценарий своей игры в этом файле.

# Определение персонажей игры.
define rating = 0
define g = Character('Георгий', color="#b4befe")
define p = Character('Министр', color="#cba6f7")
define a = Character('Настя', color="#f38ba8")
define b = Character('Бабушка')
define f = Character('Фермер')
define m = Character('Молодая мама')
define audio.g_voice1 = "audio/voice/g_voice1.opus"
image city = "city.png"
image fun = "fun.png"
# Вместо использования оператора image можете просто
# складывать все ваши файлы изображений в папку images.
# Например, сцену bg room можно вызвать файлом "bg room.png",
# а eileen happy — "eileen happy.webp", и тогда они появятся в игре.

# Игра начинается здесь:
label start:
    show city
    with dissolve
    play music "ost/intro.ogg" volume 0.6 fadeout 2.0 fadein 2.0 loop

    """Давным-давно с двух сторон реки расположились два города,
    которые всю свою историю состязались между собой
    за статус самого инновационного города.

    В один день их борьба закончилась,
    но это был не конец всей истории,
    ведь теперь в проигравшем городе
    началась экологическая катастрофа:

    Вода сильно загрязнилась из-за новых заводов, не следящих за своими отходами."""

    "И теперь"
    "ТЕБЕ"
    "нужно это решить."
    stop music fadeout 3.0

python:
    name = renpy.input("Как тебя зовут?")
    name = name.strip() or "Георгий"

label continue:
    with dissolve
    show fun
    play music "ost/ambient_2.ogg" volume 0.6 fadeout 2.0 fadein 2.0 loop
    g "Мне как-то Георгий будет ближе."

    """История повторяется, но теперь ставка куда выше — речь не о гонке технологий, а о выживании целого города.

    Недавно выборы изменили всё: новым депутатом стал... я.

    Я ещё не знаю всех офисных коридоров наизусть, но уверен — время решительных действий настало.

    {i}Рабочий день начинается.{/i}"""

    a """Георгий, поздравляю с назначением! Я — ваш помощник, и мы оба здесь новенькие.
    Город ждёт перемен… особенно с водой.
    
    Сегодня к вам приходят жители с жалобами, а министр экологии хочет поговорить."""

    stop music fadeout 1.0

    play music "ost/phone.ogg" volume 0.1
    "{i}Раздаётся звонок.{/i}"
    stop music fadeout 1.0

    play music "ost/ambient_1.ogg" volume 0.6 fadeout 2.0 fadein 2.0 loop

    "Неизвестный" """Здравствуйте, Георгий. Знаю, вы только что приняли должность, но времени на раскачку нет — у нас экстренная ситуация.

    Ой, извините, забыл представиться: я из Министерства контроля экологии."""

    p """Вчера вечером наша лаборатория зафиксировала резкое превышение уровня нитратов и пестицидов в воде.

    Основной источник — сбросы от новых фермерских хозяйств, которые используют агрессивные химикаты без контроля.
    Часть из них расположена прямо у реки, и отходы стекают напрямую.

    Вода по анализам признана непригодной не только для питья, но и для бытового использования.
    
    Уже поступили сообщения о случаях отравления — у людей проблемы с кожей, желудком, есть подозрения на массовое отравление.

    Нам пришлось ввести карантин в двух районах — жителям запрещено набирать воду из-под крана, мы развозим бутилированную, но запасов хватит максимум на три дня.

    Прочтите отчёт экологов: Выезд на место происшествия показал волну негодования среди населения.
    
    Мы выяснили, что реальный корень проблемы — отсутствие очистительных сооружений и беспорядочное использование пестицидов.

    Вот ваши основные задачи:

    1. Провести встречи с фермерами и выяснить, какие препараты используются.

    2. Проверить отчёты предприятий по фильтрации и утилизации отходов.
    
    3. Решить, кого штрафовать, кого срочно обязывать установить очистку, а где нужно действовать экстренно — отправлять специальные бригады для очистки воды.

    У вас три дня. Ситуация напряжённая, недовольство жителей растёт. До связи"""

    g "До связи"

    "{i}Звонок заканчивается.{/i}"

    a "Вчера мне писала Мария из карантинной зоны — дети заболели, помощь не доезжает. С чего начнём, Георгий?"

    stop music fadeout 2.0

label day1_morning:
    play music "ost/morning.ogg" volume 0.5 fadein 2.0 loop
    scene office_morning with fade
    a "Георгий, у нас уже очередь из жителей. Кого примем первым?"
    menu:
        "Бабушка со сковородкой":
            jump case_babushka
        "Молодая мама из карантинной зоны":
            jump case_mother

label case_babushka:
    scene office_babushka with dissolve
    show babushka at left
    b "Ой, сынок, слушай! Рыбу жарю — сковородка вся в налёте, а рыба пахнет какой-то дрянью! Всю жизнь ловлю в нашей реке, а теперь и есть страшно. Это сковородка плохая или вода у нас совсем испортилась?"
    menu:
        "Спросить, когда начались проблемы":
            b "Да вот недели две как. Соседка тоже жалуется, у неё руки после мытья чешутся"
        "Спросить, где ловит рыбу":
            b "Да прямо у моста, как всегда. Там теперь ещё и пена какая-то по утрам."
        "Спросить, кто ещё жалуется":
            b "Да все жалуются! Только никто ничего не делает."
    g "Спасибо, бабушка. Мы разберёмся."
    menu:
        "Отправить анализ рыбы и воды":
            $ rating += 1
            b "Спасибо, сынок! Хоть кто-то слушает."
        "Порекомендовать фильтр для воды":
            $ rating -= 1
            b "Фильтр? А рыбу как фильтровать? Эх, молодёжь..."
        "Пожать плечами":
            $ rating -= 2
            b "Вот так всегда... Никому мы не нужны."
    hide babushka
    jump after_case

label case_mother:
    scene office_mother with dissolve
    show mother at left
    m "Здравствуйте, у меня ребёнок заболел — сыпь после купания, вода мутная, пахнет химией. Врач говорит, что это из-за воды. Что нам делать?"
    menu:
        "Спросить, когда началось":
            m "Вчера вечером. Соседи тоже жалуются."
        "Спросить, есть ли у соседей похожее":
            m "Да, у многих дети сыпью покрылись."
        "Спросить, в каком районе живёт":
            m "В карантинной зоне, на улице Лесной."
    g "Спасибо, мы постараемся помочь."
    menu:
        "Срочно отключить воду в районе":
            $ rating += 1
            m "Спасибо! Хоть кто-то реагирует."
        "Организовать подвоз чистой воды":
            $ rating += 2
            m "Спасибо огромное! Вы нас спасаете."
        "Порекомендовать кипятить воду":
            $ rating -= 1
            m "Мы уже кипятим, но это не помогает!"
    hide mother
    jump after_case

label after_case:
    a "Следующий!"
    menu:
        "Принять ещё одного жителя":
            # Здесь можно добавить следующий кейс, например, фермер или рабочий завода
            jump case_farmer
        "Перейти к встрече с фермерами":
            jump meeting_farmers

label case_farmer:
    scene office_farmer with dissolve
    show farmer at left
    f "Здравствуйте, я фермер. Говорят, что мы виноваты в отравлении воды, но это всё неправда! Мы используем только разрешённые препараты."
    menu:
        "Спросить, какие препараты используются":
            f "Ну, удобрения обычные, как у всех. Названия... эээ... не помню, бумажки дома."
        "Спросить, есть ли очистные сооружения":
            f "Нет, у нас маленькое хозяйство, нам это не по карману."
        "Спросить, кто поставщик химикатов":
            f "Поставщик из соседнего города, всё официально!"
    g "Спасибо за информацию."
    menu:
        "Обязать установить очистку":
            $ rating += 1
            f "Это дорого, но если надо — будем думать."
        "Оштрафовать":
            $ rating -= 1
            f "Да за что! Мы и так еле выживаем!"
        "Пожурить и отпустить":
            $ rating -= 2
            f "Вот так всегда, только ругают..."
    hide farmer
    jump after_case2

label after_case2:
    a "Георгий, пора проверить отчёты предприятий. Пойдём?"
    menu:
        "Проверить отчёты лично":
            jump check_reports
        "Поручить помощнику":
            jump check_reports_assistant

label check_reports:
    scene office_reports with dissolve
    a "Вот отчёты. Смотрите, тут странные расхождения — по документам всё чисто, а по анализам — превышение в 10 раз."
    menu:
        "Вызвать полицию":
            $ rating += 2
            a "Серьёзный шаг, но, возможно, правильный."
        "Дать время на исправление":
            $ rating -= 1
            a "Надеюсь, они не воспользуются этим, чтобы всё замять."
        "Публично объявить о нарушениях":
            $ rating += 1
            a "Жители оценят вашу решимость."
    jump end_of_day

label check_reports_assistant:
    a "Я всё проверю и доложу вам к вечеру."
    jump end_of_day

label end_of_day:
    scene office_evening with fade
    a "День окончен. Сегодня вы решили несколько кейсов. Рейтинг среди жителей: [rating]."
    play music "ost/night.ogg" volume 0.3 fadein 2.0 loop
    g "Надеюсь, завтра будет легче..."
    "{i}Георгий ложится спать, но тревожные мысли не дают уснуть...{/i}"
    jump day2_intro

label day2_intro:
    # Здесь начинается второй день, посвящённый утилизации отходов
    # Можно добавить новые кейсы и продолжить сюжет по аналогии
return